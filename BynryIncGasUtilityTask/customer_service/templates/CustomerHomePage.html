{% extends 'Main.html' %}


{% block content %}
<div class="">
    <div class="card shadow">
        <div class="card-body">
            <form method="POST" enctype="multipart/form-data">
                {% csrf_token %}
                
                <div class="mb-3">
                    <label for="service_type" class="form-label">Service Type</label>
                    {{ form.service_type }}
                </div>

                <div class="mb-3">
                    <label for="stateInput" class="form-label">State</label>
                    <input type="text" id="stateInput" class="form-control" placeholder="Type to search...">
                    <div id="stateDropdown" class="dropdown-menu w-100"></div>
                    <input type="hidden" name="state" id="selectedState">
                </div>

                <div class="mb-3">
                    <label for="address" class="form-label">Address</label>
                    {{ form.address }}
                </div>

                <div class="mb-3">
                    <label for="document" class="form-label">Upload Document (Optional)</label>
                    {{ form.document }}
                </div>

                <button type="submit" class="btn btn-primary w-100">Submit Complaint</button>
            </form>
        </div>
    </div>
</div>

<script>
$(document).ready(function () {
    let states = [
        "Andhra Pradesh", "Arunachal Pradesh", "Assam", "Bihar", "Chhattisgarh", "Goa", "Gujarat", 
        "Haryana", "Himachal Pradesh", "Jharkhand", "Karnataka", "Kerala", "Madhya Pradesh", 
        "Maharashtra", "Manipur", "Meghalaya", "Mizoram", "Nagaland", "Odisha", "Punjab", 
        "Rajasthan", "Sikkim", "Tamil Nadu", "Telangana", "Tripura", "Uttar Pradesh", 
        "Uttarakhand", "West Bengal"
    ];

    $("#stateInput").on("input", function () {
        let query = $(this).val().toLowerCase();
        let filteredStates = states.filter(state => state.toLowerCase().startsWith(query));
        let dropdown = $("#stateDropdown");
        dropdown.empty();

        if (query.length > 0) {
            dropdown.addClass("show");
            filteredStates.forEach(state => {
                dropdown.append(`<div class="dropdown-item state-option">${state}</div>`);
            });

            $(".state-option").on("click", function () {
                let selectedState = $(this).text();
                $("#stateInput").val(selectedState);
                $("#selectedState").val(selectedState);
                dropdown.removeClass("show");
            });
        } else {
            dropdown.removeClass("show");
        }
    });

    $(document).click(function (event) {
        if (!$(event.target).closest("#stateInput").length) {
            $("#stateDropdown").removeClass("show");
        }
    });
});
</script>
{% endblock %}
